/* ── LCARS Layout Grid ──────────────────────────────────────────
   Defines the CSS Grid structure for the LCARS frame.
   Only applies when the LCARS theme is active.

   The frame (header, sidebar, footer, elbows) stays pinned to the
   viewport at all times.  Only the content area scrolls.

   Key: every item in the middle row (sidebar, cascade, content) needs
   min-height:0 so the 1fr track can shrink below the items' content
   size — without it, tall content forces the row open and the whole
   page scrolls instead of just the content area.
   ─────────────────────────────────────────────────────────────── */

.lcars-layout {
  display: grid;
  grid-template-columns: 200px 5px 1fr;
  grid-template-rows: 56px 1fr 36px;
  grid-template-areas:
    "elbow-tl header  header"
    "sidebar  cascade content"
    "elbow-bl footer  footer";
  height: 100dvh;
  background: #000000;
  overflow: hidden;
  /* Push content below iOS status bar in standalone PWA mode */
  padding-top: env(safe-area-inset-top, 0px);
}

.lcars-elbow-tl {
  grid-area: elbow-tl;
}

.lcars-header {
  grid-area: header;
}

/* ── Middle row items all need min-height:0 ───────────────────── */

.lcars-sidebar {
  grid-area: sidebar;
  min-height: 0;
  overflow: hidden;
}

.lcars-cascade {
  grid-area: cascade;
  min-height: 0;
  overflow: hidden;
}

.lcars-content {
  grid-area: content;
  min-height: 0;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 2rem;
  background: #000000;
}

/* ── Bottom row ───────────────────────────────────────────────── */

.lcars-elbow-bl {
  grid-area: elbow-bl;
}

.lcars-footer {
  grid-area: footer;
}

/* ── Modern Variant: 4-corner elbow frame ────────────────────── */
/* Replaces right sidebar with a decorative right strip framed
   by TR and BR elbows. Creates a complete frame around the
   content area.
   Grid: sidebar | cascade | content | right-strip
   Elbows sit in all four corners. */

.lcars-layout.lcars-modern-layout {
  grid-template-columns: 200px 5px 1fr 48px;
  grid-template-rows: 56px 1fr 36px;
  grid-template-areas:
    "elbow-tl header  header  elbow-tr"
    "sidebar  cascade content right-strip"
    "elbow-bl footer  footer  elbow-br";
}

/* Right-side grid areas */
.lcars-elbow-tr {
  grid-area: elbow-tr;
}

.lcars-right-strip {
  grid-area: right-strip;
  min-height: 0;
  overflow: hidden;
  /* Layout styles moved from inline to CSS so mobile display:none works */
  display: flex;
  flex-direction: column;
  gap: 3px;
  padding: 3px 0;
  background: #000;
}

.lcars-right-strip-pill {
  border-radius: 0 16px 16px 0;
  opacity: 0.7;
}

.lcars-elbow-br {
  grid-area: elbow-br;
}

/* ── Alert State Classes (Frame-Level) ────────────────────── */
/* Red Alert: header/footer bars get red glow */

.lcars-alert-red .lcars-header > div,
.lcars-alert-red .lcars-footer > div {
  animation: lcars-red-alert-glow 2s ease-in-out infinite;
}

/* Yellow Alert: header/footer get warm glow (static) */

.lcars-alert-yellow .lcars-header > div,
.lcars-alert-yellow .lcars-footer > div {
  box-shadow: 0 0 8px rgba(255, 153, 102, 0.2);
}

/* ── Mobile Fallback (< 768px) ─────────────────────────────── */

@media (max-width: 768px) {
  .lcars-layout {
    grid-template-columns: 1fr;
    grid-template-rows: 48px 1fr 56px;
    grid-template-areas:
      "header"
      "content"
      "footer";
  }

  .lcars-sidebar,
  .lcars-cascade,
  .lcars-elbow-tl,
  .lcars-elbow-bl,
  .lcars-elbow-tr,
  .lcars-right-strip,
  .lcars-elbow-br {
    display: none !important;
  }

  /* Force modern variant to single column on mobile */
  .lcars-layout.lcars-modern-layout {
    grid-template-columns: 1fr;
    grid-template-rows: 48px 1fr 56px;
    grid-template-areas:
      "header"
      "content"
      "footer";
  }

  .lcars-header-decor {
    display: none !important;
  }

  /* Prevent any horizontal overflow on mobile */
  .lcars-header {
    overflow: hidden;
  }

  .lcars-content {
    padding: 1rem;
    max-width: 100vw;
  }
}
